name: Optimize Emojis with SVGO

on:
  workflow_dispatch: # Run manually
  push:
    paths:
      - "sprite/**.svg" # Run when emoji SVGs change

jobs:
  optimize:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v4

      - name: âš™ï¸ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: ğŸ“¦ Install SVGO
        run: npm install -g svgo

      - name: ğŸ§¹ Create output folder
        run: mkdir -p optimized

      - name: ğŸš€ Optimize all SVG emojis
        run: |
          for f in sprite/*.svg; do
            echo "Optimizing $f..."
            svgo --config=svgo.config.js "$f" -o "optimized/$(basename "$f")"
          done

      - name: ğŸ“¦ Compress optimized emojis
        run: zip -r optimized-emojis.zip optimized

      - name: â¬†ï¸ Upload optimized ZIP artifact
        uses: actions/upload-artifact@v4
        with:
          name: optimized-emojis
          path: optimized-emojis.zip
